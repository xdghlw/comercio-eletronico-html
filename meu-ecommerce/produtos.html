<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Produtos</title>
    <link rel="stylesheet" href="/meu-ecommerce/css/style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</head>

<body>
    <header>
        <!-- Navbar bootstrap -->
        <nav class="navbar navbar-expand-lg bg-body-tertiary">
            <div id="index-container-fluid" class="container-fluid">

                <div class="dropdown">
                    <button class="btn btn-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown"
                        aria-expanded="false">
                        <i class="bi bi-person-fill"></i>
                    </button>
                    <ul id="cabecalho" class="dropdown-menu">

                    </ul>
                </div>

                <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                    aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0">

                        <li class="nav-item">
                            <a class="nav-link active" href="index.html">
                                <i class="bi bi-house-door"></i>
                                Página inicial
                            </a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link active" href="carrinho.html">
                                <i class="bi bi-cart2 mx-1"></i>
                                Carrinho de Compras
                            </a>
                        </li>
                    </ul>
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item">
                            <a class="nav-link active" aria-current="page" href="contato.html">Contato<small><i
                                        class="bi bi-chat-left-dots mx-1"></i></small></a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>

    </header>

    <main>

        <div id="container-linhas" class="container text-center">

            <div id="l1" class="row my-4">

            </div>
            <div id="l2" class="row my-4">

            </div>
            <div id="l3" class="row my-4">

            </div>
            <div id="l4" class="row my-4">

            </div>


        </div>

        <nav aria-label="Page navigation example">
            <ul class="pagination justify-content-center">
                <li class="page-item">
                    <a class="page-link" href="#" aria-label="Previous">
                        <span aria-hidden="true">&laquo;</span>
                    </a>
                </li>
                <li class="page-item"><a class="page-link" href="#">1</a></li>
                <li class="page-item"><a class="page-link" href="#">2</a></li>
                <li class="page-item"><a class="page-link" href="#">3</a></li>
                <li class="page-item">
                    <a class="page-link" href="#" aria-label="Next">
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
            </ul>
        </nav>

    </main>
    <footer>
        <!-- <a href="index.html">Voltar</a> -->
    </footer>

    <script>
        fetch("https://ppw-1-tads.vercel.app/api/products")
            .then(response => {
                // if (!response.ok) {
                //     throw new Error("Erro na requisição");
                // }
                return response.json();
            })
            .then(data => {
                const chaves = Object.keys(data.products[0]);
                const produtos = data.products;
                console.log(data);
                console.log(chaves);

                console.log(produtos);

                // for (let index = 0; index < produtos.length; index++) {

                //     const element = produtos[index];
                //     console.log(element.id);
                //     console.log(element.name);
                //     console.log(element.description);
                //     console.log(element.price);
                //     console.log(element.image);

                // }


                function adicionarCard() {

                    var id = 1;
                    var linha1 = "l";

                    for (let index = 0; index < produtos.length; index++) {
                        const produto = produtos[index];

                        const linha = document.getElementById(linha1.concat(id.toString()));

                        const coluna = document.createElement("div");
                        coluna.classList.add("col-6", "col-sm-6", "col-md-6", "col-lg-6", "col-xl-3", "col-xxl-3");

                        const card = document.createElement("div");
                        card.className = "card h-100";
                        card.style.width = "18rem";

                        const img = document.createElement("img");
                        img.src = produto.image;
                        img.className = "card-img-top";
                        img.alt = "Carro";

                        const cardBody = document.createElement("div");
                        cardBody.className = "card-body border-top";

                        const header = document.createElement("h5");
                        header.className = "card-title";
                        header.textContent = produto.name;

                        const p = document.createElement("p");
                        p.className = "card-text";
                        p.textContent = "R$ ".concat(produto.price);

                        const p2 = document.createElement("p");
                        p2.className = "card-text";
                        p2.textContent = produto.description;

                        const a = document.createElement("a");
                        a.className = "btn btn-primary";
                        a.href = "#";
                        a.textContent = "Adicionar ao Carrinho";

                        cardBody.appendChild(header);
                        cardBody.appendChild(p);
                        cardBody.appendChild(p2);
                        cardBody.appendChild(a);

                        card.appendChild(img);
                        card.appendChild(cardBody);

                        coluna.appendChild(card);
                        linha.appendChild(coluna);

                        if (((index + 1) % 4 == 0) && id < 5) {
                            id += 1;
                        }
                    }

                }
                adicionarCard();
            })

    </script>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            atualizarMenuAvatar();
        });

        function atualizarMenuAvatar() {
            const menu = document.getElementById("cabecalho");
            menu.innerHTML = "";

            const usuarioLogado = localStorage.getItem("usuarioLogado");

            if (!usuarioLogado) {
                // Usuário NÃO logado
                menu.innerHTML = `
                <li><a class="dropdown-item" href="login.html">Entrar</a></li>
                <li><a class="dropdown-item" href="cadastro.html">Cadastrar</a></li>
            `;

            } else {

                menu.innerHTML = `
                <li><a class="dropdown-item" href="meus_dados.html">Meus Dados</a></li>
                <li><a class="dropdown-item" href="meus_pedidos.html">Meus Pedidos</a></li>
                <li><hr class="dropdown-divider"></li>
                <li><a class="dropdown-item text-danger" href="#" onclick="finalizarSessao()">Sair</a></li>
            `;
            }
        }

        function finalizarSessao() {
            localStorage.removeItem("usuarioLogado");
            window.location.href = "index.html";
        }

    </script>

</body>

</html>